(function(){"use strict";var t={954:function(t,e,s){var r=s(471),a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("nav",{staticClass:"navbar navbar-expand-lg navbar-dark bg-primary"},[e("div",{staticClass:"container"},[e("a",{staticClass:"navbar-brand",attrs:{href:"#"}},[t._v("ðŸ“š Book Store")]),e("button",{staticClass:"btn btn-outline-light ml-auto",attrs:{disabled:!t.cartItems.length},on:{click:function(e){t.currentPage="cart"}}},[t._v(" ðŸ›’ Cart ("+t._s(t.cartItems.length)+") ")])])]),"lessons"===t.currentPage?e("div",{staticClass:"container mt-4"},[e("div",{staticClass:"row mb-4"},[e("div",{staticClass:"col-12"},[e("h2",[t._v("ðŸ“‹ Available Books")]),e("div",{staticClass:"search-bar mb-3"},[e("div",{staticClass:"input-group"},[t._m(0),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],staticClass:"form-control form-control-lg",attrs:{type:"text",placeholder:"Search books by title, genre, price, or stock... (search as you type)"},domProps:{value:t.searchQuery},on:{input:[function(e){e.target.composing||(t.searchQuery=e.target.value)},t.onSearchInput]}}),t.searchQuery?e("div",{staticClass:"input-group-append"},[e("button",{staticClass:"btn btn-outline-secondary",on:{click:t.clearSearch}},[t._v(" âŒ Clear ")])]):t._e()]),t.searchQuery?e("small",{staticClass:"text-muted"},[t._v(" Showing "+t._s(t.displayedLessons.length)+' result(s) for "'+t._s(t.searchQuery)+'" ')]):t._e()]),e("div",{staticClass:"sort-controls"},[e("label",[t._v("ðŸ” Sort by:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.sortBy,expression:"sortBy"}],staticClass:"form-control d-inline-block w-auto mx-2",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.sortBy=e.target.multiple?s:s[0]}}},[e("option",{attrs:{value:"subject"}},[t._v("Title")]),e("option",{attrs:{value:"location"}},[t._v("Genre")]),e("option",{attrs:{value:"price"}},[t._v("Price")]),e("option",{attrs:{value:"spaces"}},[t._v("Stock")])]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.sortOrder,expression:"sortOrder"}],staticClass:"form-control d-inline-block w-auto",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.sortOrder=e.target.multiple?s:s[0]}}},[e("option",{attrs:{value:"asc"}},[t._v("â¬†ï¸ Ascending")]),e("option",{attrs:{value:"desc"}},[t._v("â¬‡ï¸ Descending")])])])])]),e("div",{staticClass:"row"},t._l(t.displayedLessons,function(s){return e("div",{key:s.id,staticClass:"col-md-4 mb-4"},[e("div",{staticClass:"card h-100"},[e("div",{staticClass:"card-body"},[e("h5",{staticClass:"card-title"},[t._v(t._s(s.emoji)+" "+t._s(s.subject))]),e("p",{staticClass:"card-text"},[t._v(" ðŸ“š Genre: "+t._s(s.location)),e("br"),t._v(" ðŸ’° Price: $"+t._s(s.price)),e("br"),t._v(" ðŸ“¦ In Stock: "+t._s(s.spaces)+" ")]),e("button",{staticClass:"btn btn-primary w-100",attrs:{disabled:0===s.spaces},on:{click:function(e){return t.addToCart(s)}}},[t._v(" ðŸ›’ Add to Cart ")])])])])}),0),t.searchQuery&&0===t.displayedLessons.length?e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 text-center mt-5"},[e("h3",[t._v("ðŸ˜” No books found")]),e("p",[t._v("Try searching for something else...")]),e("button",{staticClass:"btn btn-primary",on:{click:t.clearSearch}},[t._v("Clear Search")])])]):t._e()]):t._e(),"cart"===t.currentPage?e("div",{staticClass:"container mt-4"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("h2",[t._v("ðŸ›’ Shopping Cart")]),e("button",{staticClass:"btn btn-outline-primary mb-4",on:{click:function(e){t.currentPage="lessons"}}},[t._v(" â¬…ï¸ Back to Books ")])])]),t.cartItems.length?e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-8"},t._l(t.cartItems,function(s){return e("div",{key:s.id,staticClass:"card mb-3"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"d-flex justify-content-between align-items-center"},[e("div",[e("h5",{staticClass:"card-title"},[t._v(t._s(s.emoji)+" "+t._s(s.subject))]),e("p",{staticClass:"card-text mb-0"},[t._v(" ðŸ“š "+t._s(s.location)+" | ðŸ’° $"+t._s(s.price)+" ")])]),e("button",{staticClass:"btn btn-danger",on:{click:function(e){return t.removeFromCart(s)}}},[t._v(" âŒ Remove ")])])])])}),0),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("h5",{staticClass:"card-title"},[t._v("ðŸ’° Order Summary")]),e("p",{staticClass:"card-text"},[t._v(" Total Items: "+t._s(t.cartItems.length)),e("br"),t._v(" Total Price: $"+t._s(t.cartTotal)+" ")]),e("button",{staticClass:"btn btn-success w-100",on:{click:function(e){t.currentPage="checkout"}}},[t._v(" ðŸ’³ Proceed to Checkout ")])])])])]):e("div",{staticClass:"text-center mt-5"},[e("h3",[t._v("Your cart is empty ðŸ›’")]),e("button",{staticClass:"btn btn-primary mt-3",on:{click:function(e){t.currentPage="lessons"}}},[t._v(" Continue Shopping ")])])]):t._e(),"checkout"===t.currentPage?e("div",{staticClass:"container mt-4"},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("h2",{staticClass:"card-title text-center"},[t._v("ðŸ’³ Checkout")]),e("form",{on:{submit:function(e){return e.preventDefault(),t.submitOrder.apply(null,arguments)}}},[e("div",{staticClass:"form-group"},[e("label",[t._v("ðŸ§â€â™‚ï¸ Name (letters only)")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.checkoutForm.name,expression:"checkoutForm.name"}],staticClass:"form-control",attrs:{type:"text",pattern:"[A-Za-z ]+",required:""},domProps:{value:t.checkoutForm.name},on:{input:function(e){e.target.composing||t.$set(t.checkoutForm,"name",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",[t._v("ðŸ“ž Phone (numbers only)")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.checkoutForm.phone,expression:"checkoutForm.phone"}],staticClass:"form-control",attrs:{type:"tel",pattern:"[0-9]+",required:""},domProps:{value:t.checkoutForm.phone},on:{input:function(e){e.target.composing||t.$set(t.checkoutForm,"phone",e.target.value)}}})]),e("div",{staticClass:"text-center mt-4"},[e("button",{staticClass:"btn btn-outline-secondary mr-2",attrs:{type:"button"},on:{click:function(e){t.currentPage="cart"}}},[t._v(" â¬…ï¸ Back to Cart ")]),e("button",{staticClass:"btn btn-success",attrs:{type:"submit",disabled:!t.isCheckoutValid}},[t._v(" âœ… Place Order ")])])])])])])])]):t._e()])},o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[t._v("ðŸ”")])])}],i={name:"App",data(){return{API_URL:{NODE_ENV:"production",BASE_URL:"/bookstore-frontend/"}.VUE_APP_API_URL||"http://localhost:3000",currentPage:"lessons",lessons:[],searchResults:[],searchQuery:"",searchDebounceTimer:null,cartItems:[],sortBy:"subject",sortOrder:"asc",checkoutForm:{name:"",phone:""}}},computed:{displayedLessons(){const t=this.searchQuery?this.searchResults:this.lessons;return[...t].sort((t,e)=>{let s="asc"===this.sortOrder?1:-1;return"price"===this.sortBy||"spaces"===this.sortBy?(t[this.sortBy]-e[this.sortBy])*s:t[this.sortBy].localeCompare(e[this.sortBy])*s})},sortedLessons(){return this.displayedLessons},cartTotal(){return this.cartItems.reduce((t,e)=>t+e.price,0)},isCheckoutValid(){const t=/^[A-Za-z ]+$/,e=/^[0-9]+$/;return t.test(this.checkoutForm.name)&&e.test(this.checkoutForm.phone)}},created(){this.fetchBooks()},methods:{async fetchBooks(){try{const t=await fetch(`${this.API_URL}/api/books`),e=await t.json();this.lessons=e.map(t=>({...t,id:t._id}))}catch(t){console.error("Error fetching books:",t),alert("Failed to load books. Please try again later.")}},async searchBooks(t){try{console.log(`ðŸ” Searching for: "${t}"`);const e=await fetch(`${this.API_URL}/api/search?q=${encodeURIComponent(t)}`),s=await e.json();this.searchResults=s.map(t=>({...t,id:t._id})),console.log(`âœ… Found ${this.searchResults.length} results`)}catch(e){console.error("Error searching books:",e),alert("Failed to search books. Please try again.")}},onSearchInput(){this.searchDebounceTimer&&clearTimeout(this.searchDebounceTimer),this.searchQuery&&""!==this.searchQuery.trim()?this.searchDebounceTimer=setTimeout(()=>{this.searchBooks(this.searchQuery)},300):this.searchResults=[]},clearSearch(){this.searchQuery="",this.searchResults=[],this.searchDebounceTimer&&clearTimeout(this.searchDebounceTimer)},async addToCart(t){if(t.spaces>0)try{const e=await fetch(`${this.API_URL}/api/books/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({spaces:t.spaces-1})});if(!e.ok)throw new Error("Failed to update book stock");{this.cartItems.push({...t});const e=this.lessons.findIndex(e=>e.id===t.id);this.lessons[e].spaces--}}catch(e){console.error("Error updating book stock:",e),alert("Failed to add book to cart. Please try again.")}},async removeFromCart(t){try{const e=await fetch(`${this.API_URL}/api/books/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({spaces:t.spaces+1})});if(!e.ok)throw new Error("Failed to update book stock");{const e=this.cartItems.findIndex(e=>e.id===t.id);if(e>-1){this.cartItems.splice(e,1);const s=this.lessons.findIndex(e=>e.id===t.id);this.lessons[s].spaces++}}}catch(e){console.error("Error updating book stock:",e),alert("Failed to remove book from cart. Please try again.")}},async submitOrder(){if(this.isCheckoutValid)try{const t={name:this.checkoutForm.name,phone:this.checkoutForm.phone,books:this.cartItems.map(t=>({id:t.id,subject:t.subject,price:t.price}))},e=await fetch(`${this.API_URL}/api/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error("Failed to submit order");alert("âœ… Order submitted successfully!"),this.cartItems=[],this.checkoutForm.name="",this.checkoutForm.phone="",this.currentPage="lessons",await this.fetchBooks()}catch(t){console.error("Error submitting order:",t),alert("Failed to submit order. Please try again.")}}}},c=i,n=s(656),l=(0,n.A)(c,a,o,!1,null,null,null),u=l.exports;r.Ay.config.productionTip=!1,new r.Ay({render:t=>t(u)}).$mount("#app")}},e={};function s(r){var a=e[r];if(void 0!==a)return a.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,r,a,o){if(!r){var i=1/0;for(u=0;u<t.length;u++){r=t[u][0],a=t[u][1],o=t[u][2];for(var c=!0,n=0;n<r.length;n++)(!1&o||i>=o)&&Object.keys(s.O).every(function(t){return s.O[t](r[n])})?r.splice(n--,1):(c=!1,o<i&&(i=o));if(c){t.splice(u--,1);var l=a();void 0!==l&&(e=l)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[r,a,o]}}(),function(){s.d=function(t,e){for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,r){var a,o,i=r[0],c=r[1],n=r[2],l=0;if(i.some(function(e){return 0!==t[e]})){for(a in c)s.o(c,a)&&(s.m[a]=c[a]);if(n)var u=n(s)}for(e&&e(r);l<i.length;l++)o=i[l],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(u)},r=self["webpackChunkafter_school_frontend"]=self["webpackChunkafter_school_frontend"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=s.O(void 0,[504],function(){return s(954)});r=s.O(r)})();
//# sourceMappingURL=app.5f347cc1.js.map